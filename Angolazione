#include <Wire.h>
#include <Adafruit_PWMServoDriver.h>

Adafruit_PWMServoDriver servo = Adafruit_PWMServoDriver();

#define SERVOMIN 120    // Valore minimo per il servo
#define SERVOMAX 470    // Valore massimo per il servo
#define SERVO_FREQ 50   // Frequenza per servomotori (tipicamente 50 Hz)

int servonum = 0;      // Numero del servo sulla PCA9685 (da 0 a 15)
int posizione = 0;     // Posizione PWM calcolata
int angolo = 0;        // Angolo desiderato in gradi

void setup() {
  Serial.begin(115200);

  Serial.println("inizio setup");

  servo.begin();
  servo.setOscillatorFrequency(27000000);  // Frequenza dell'oscillatore interna
  servo.setPWMFreq(SERVO_FREQ);            // Imposta la frequenza del segnale PWM
  delay(100);
  servonum = 12;

  // Muove il servo a 90 gradi
  angolo = 90;
  posizione = map(angolo, 0, 180, SERVOMIN, SERVOMAX);
  Serial.println("setpwm");
  servo.setPWM(servonum, 0, posizione);

  Serial.println("fine setup");
}

void loop() {
  

  /*
  servonum = 9;

  // Muove il servo a 90 gradi
  angolo = 90;
  posizione = map(angolo, 0, 180, SERVOMIN, SERVOMAX);
  servo.setPWM(servonum, 0, posizione);
  servonum = 10;

  // Muove il servo a 90 gradi
  angolo = 90;
  posizione = map(angolo, 0, 180, SERVOMIN, SERVOMAX);
  servo.setPWM(servonum, 0, posizione);

  servonum = 11;

  // Muove il servo a 90 gradi
  angolo = 90;
  posizione = map(angolo, 0, 180, SERVOMIN, SERVOMAX);
  servo.setPWM(servonum, 0, posizione);
  servonum = 12;

  // Muove il servo a 90 gradi
  angolo = 0;
  posizione = map(angolo, 0, 180, SERVOMIN, SERVOMAX);
  servo.setPWM(servonum, 0, posizione);
  delay(500);*/
}
